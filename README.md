# KiCad BOM plugin

Another BOM plugin for KiCad. This one can read & parse the KiCad XML file directly. It can write the BOM either to a CSV or XLSX file.

## Features

- Groups identical components togeather and outputs a BOM in which each component type is provided with its count and a list of designators.
- Determines kind of a component basing on its designator
- Sensitive to additional "special" fields:
	- "type" - A string field that can be used to distinguish eg. capacitor types (ceramic, tantalum etc.)
	- "tolerance" - A string with component tolerance information,
	- "rating" - A string defining a component rating (eg. max voltage),
	- "vendor" - The vendor/manufacturer name,
	- "vendor_id" - The vendor/manufacturer part number.
- Special fields are treated as unique component parameters and appear as separate BOM columns.

## Requirements

 - python3
 - xlsxwriter (only for writing XLSX files. Improted dynamically)

## Installation

- Copy the `bom-plugin.py` somewhere.
- For a CSV output add a new BOM plugin in KiCad and set the command line to:

```
python3 "bom-plugin.py" "%I" --csv "%O.csv"
```

- For a XLSX output set the command line to:

```
python3 "bom-plugin.py" "%I" --xlsx "%O.xlsx"
```

(off course provide the full path to the `bom-plugin.py`)

You can also combine both `--csv` and `--xlsx` to output the BOM in both formats simultaneously.

## Manual usage

The script can be invoked extarnally and has to be provided a path to the XML file generated by KiCad:

```
usage: bom-plugin.py [-h] [--csv CSV] [--xlsx XLSX] xml

positional arguments:
  xml          Input XML file from KiCad

optional arguments:
  -h, --help   show this help message and exit
  --csv CSV    Output CSV file
  --xlsx XLSX  Output XLSX file
```